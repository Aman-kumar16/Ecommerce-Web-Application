<div class="container">
   <div class="m-4">
    <form [formGroup]="checkoutFormGroup" (ngSubmit)="onSubmit()">    
    
        
        <!-- shipping address form -->
        <div formGroupName="shippingAddress" class="form-area">
            <h4>Shipping Address</h4>

            <div class="form-group">
                <div class="row mt-3">
                    <label for="country" class="col-sm-3 col-form-label col-form-label-lg">Country</label>
                    <div class="col-sm-8 ">
                        <select formControlName="country" (change)="getStates()" id="country" class="form-control " >
                            <option *ngFor="let country of countries" [ngValue]="country">{{country.name}}</option>
                        </select>
                        <div *ngIf="shippingCountry?.invalid && (shippingCountry?.dirty || shippingCountry?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="shippingCountry?.errors?.['required']">
                                Country is required
                            </div>
                        </div>
                    </div>
                </div>

                <div class=" row mt-3">
                    <label for="street" class="col-sm-3 col-form-label col-form-label-lg">Street</label>
                    <div class="col-sm-8 ">
                        <input formControlName="street" id="street" type="text" class="form-control " placeholder="Enter your street">
                    
                        <div *ngIf="shippingStreet?.invalid && (shippingStreet?.dirty || shippingStreet?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="shippingStreet?.errors?.['required'] || shippingStreet?.errors?.['notOnlyWhitespace']">
                                Street is required
                            </div>
                            <div *ngIf="shippingStreet?.errors?.['minlength']">
                                Street must be at least 2 characters long
                            </div>
                        </div>

                    </div>
                </div>

                <div class=" row mt-3 mb-3">
                    <label for="city" class="col-sm-3 col-form-label col-form-label-lg">City</label>
                    <div class="col-sm-8 ">
                        <input formControlName="city" id="city" type="text" class="form-control " placeholder="Enter your city">
                    
                        <div *ngIf="shippingCity?.invalid && (shippingCity?.dirty || shippingCity?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="shippingCity?.errors?.['required'] || shippingCity?.errors?.['notOnlyWhitespace']">
                                City is required
                            </div>
                            <div *ngIf="shippingCity?.errors?.['minlength']">
                                City must be at least 2 characters long
                            </div>
                        </div>
                    
                    </div>
                </div>

                <div class=" row mt-3 mb-3">
                    <label for="state" class="col-sm-3 col-form-label col-form-label-lg">State</label>
                    <div class="col-sm-8 ">
                        <select formControlName="state" id="state" class="form-control " >
                            <option *ngFor="let state of states" [ngValue]="state">{{state.name}}</option>
                        </select>

                        <div *ngIf="shippingState?.invalid && (shippingState?.dirty || shippingState?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="shippingState?.errors?.['required']">
                                State is required
                            </div>
                        </div>
                    </div>   
                </div>

                <div class=" row mt-3 mb-3">
                    <label for="zipcode" class="col-sm-3 col-form-label col-form-label-lg">Zipcode</label>
                    <div class="col-sm-8 ">
                        <input formControlName="zipcode" id="zipcode" type="text" class="form-control " placeholder="Enter your zipcode">
                    
                        <div *ngIf="shippingZipcode?.invalid && (shippingZipcode?.dirty || shippingZipcode?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="shippingZipcode?.errors?.['required'] || shippingZipcode?.errors?.['notOnlyWhitespace']">
                                Zipcode is required
                            </div>
                            <div *ngIf="shippingZipcode?.errors?.['pattern']">
                                zipcode must be 6 digit
                            </div>
                        </div>
                    
                    </div>
                </div>

            </div>

        </div>


        <!-- Credit Card information -->
        <div formGroupName="creditCard" class="form-area">
            <h4>Credit Card</h4>

            <div class="form-group">
                <div class="row mt-3">
                    <label for="cardType" class="col-sm-3 col-form-label col-form-label-lg">Card Type</label>
                    <div class="col-sm-8 ">
                        <select formControlName="cardType" id="cardType" class="form-control " >
                            <option value="Visa">Visa</option>
                            <option value="MasterCard">MasterCard</option>
                            <!-- validation -->
                            <div *ngIf="cardType?.invalid && cardType?.touched" class="alert alert-danger mt-1">
                                <div *ngIf="cardType?.errors?.['required']">
                                    select one card type
                                </div>
                            </div>

                        </select>
                    </div>
                </div>

                <div class=" row mt-3">
                    <label for="nameOnCard" class="col-sm-3 col-form-label col-form-label-lg">Name On Card</label>
                    <div class="col-sm-8 ">
                        <input formControlName="nameOnCard" id="nameOnCard" type="text" class="form-control " placeholder="Enter your Name on Card">
                        <!-- validation -->
                        <div *ngIf="nameOnCard?.invalid && (nameOnCard?.dirty || nameOnCard?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="nameOnCard?.errors?.['required'] || nameOnCard?.errors?.['notOnlyWhitespace']">
                                Name is required
                            </div>
                            <div *ngIf="nameOnCard?.errors?.['minlength']">
                                Name  must be at least 2 characters long
                            </div>
                        </div>

                    </div>
                </div>

                <div class=" row mt-3 mb-3">
                    <label for="cardNumber" class="col-sm-3 col-form-label col-form-label-lg">Card Number</label>
                    <div class="col-sm-8 ">
                        <input formControlName="cardNumber" id="cardNumber" type="text" class="form-control " placeholder="Enter your cardNumber">
                        <!-- validation -->
                        <div *ngIf="cardNumber?.invalid && (cardNumber?.dirty || cardNumber?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="cardNumber?.errors?.['required']">
                                Card Number is required
                            </div>
                            <div *ngIf="cardNumber?.errors?.['pattern']">
                                Card Number must be of 16 digits 
                            </div>
                        </div>

                    </div>
                </div>

                <div class=" row mt-3 mb-3">
                    <label for="securityCode" class="col-sm-3 col-form-label col-form-label-lg">Security Code</label>
                    <div class="col-sm-8 ">
                        <input formControlName="securityCode" id="securityCode" type="text" class="form-control " placeholder="Enter your Security Code or cvv">
                        <!-- validation -->
                        <div *ngIf="securityCode?.invalid && (securityCode?.dirty || securityCode?.touched)" class="alert alert-danger mt-1">
                            <div *ngIf="securityCode?.errors?.['required']">
                                Security code is required
                            </div>
                            <div *ngIf="securityCode?.errors?.['pattern']">
                                Security code must be of 3 digits 
                            </div>
                        </div>

                    </div>
                </div>

                <div class="row mt-3">
                    <label for="expirationMonth" class="col-sm-3 col-form-label col-form-label-lg">Expiration Month</label>
                    <div class="col-sm-8 ">
                        <select formControlName="expirationMonth" id="expirationMonth" class="form-control " >
                            <option  *ngFor="let month of months" value="{{month}}">{{month}}</option>
                            <!-- validation required -->
                            <div *ngIf="expirationMonth?.invalid && (expirationMonth?.dirty || expirationMonth?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="expirationMonth?.errors?.['required']">
                                    Expiration Month is required
                                </div>
                            
                            </div>
                        </select>
                    </div>
                </div>

                <div class="row mt-3">
                    <label for="expirationYear" class="col-sm-3 col-form-label col-form-label-lg">Expiration Year</label>
                    <div class="col-sm-8 ">
                        <select formControlName="expirationYear" (change)="handleMonthsAndYears()" id="expirationYear" class="form-control " >
                            <option *ngFor="let year of years" value="{{year}}">{{year}}</option>
                            <!-- validation required -->
                            <div *ngIf="expirationYear?.invalid && (expirationYear?.dirty || expirationYear?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="expirationYear?.errors?.['required']">
                                    Expiration Year is required
                                </div>
                            </div>

                        </select>
                    </div>
                </div>

            </div>
        </div>

         <!-- Review Order -->
        <div class="form-area" style="font-size: large;">
            <h4 class="mt-3">Review Your Order</h4>
            <p>Total Quantity: {{totalQuantity}} </p>
            <p>Shipping: {{shippingCharges | currency: 'USD'}}</p>
            <p>Total Price: {{totalPrice | currency: 'USD'}}</p>
        </div>

        <!-- submit button -->
        <div class="text-center">
            <button type="submit" class="btn btn-primary" style="padding: 0.375rem 6.75rem;">Place Order </button>
        </div>
       

    </form>
    
   </div>
</div>



